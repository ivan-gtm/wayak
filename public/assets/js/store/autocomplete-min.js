function debounce(e,t){let n;return function(){const o=this,s=arguments;clearTimeout(n),n=setTimeout((()=>e.apply(o,s)),t)}}function fetchData(e,t){const n=new XMLHttpRequest;n.open("GET",autocompleteURL+`?prefix=${e}`,!0),n.onreadystatechange=function(){if(4===this.readyState&&200===this.status){const e=JSON.parse(this.responseText);t(e)}},n.send()}function displayResults(e,t){t.innerHTML="",e.forEach((e=>{const n=document.createElement("a"),o=document.getElementById("nav-search-input"),s=document.querySelector(".autocomplete-results");n.classList.add("autocomplete-item"),n.innerText=e,n.onclick=function(){o.value=e,o.form.submit(),s.innerHTML=""},t.appendChild(n)}))}function displayPopularSearches(e){const t=undefined,n=undefined;displayResults(JSON.parse(localStorage.getItem("popularSearches")).map((e=>e.term)),e)}function positionResultsContainer(e,t){const n=e.getBoundingClientRect();t.style.top=n.bottom+window.scrollY+"px",t.style.left=n.left+window.scrollX+"px",t.style.width=n.width+"px"}const autocompleteURL=localStorage.getItem("autocompleteURL"),popularSearchesURL=localStorage.getItem("popularSearchesURL");document.addEventListener("DOMContentLoaded",(function(){const e=document.getElementById("nav-search-input"),t=document.createElement("div");t.classList.add("autocomplete-results");var n=-1,o=document.querySelector("#overlay"),s=document.querySelector("header");document.body.appendChild(t),e.addEventListener("keyup",debounce((function(n){const o=n.target.value;""===e.value?(displayPopularSearches(t),positionResultsContainer(e,t)):o.length>2&&fetchData(o,(function(n){displayResults(n,t),positionResultsContainer(e,t)}))}),300)),e.addEventListener("focus",(function(){o.style.display="block",""===e.value?(displayPopularSearches(t),positionResultsContainer(e,t)):e.value.length>2&&fetchData(e.value,(function(n){displayResults(n,t),positionResultsContainer(e,t)}))})),o.addEventListener("click",(function(){o.style.display="none",t.innerHTML=""})),s.addEventListener("click",(function(){var n;document.activeElement===e||(o.style.display="none",t.innerHTML="")})),e.addEventListener("keydown",(function(o){const s=t.querySelectorAll(".autocomplete-item");s.forEach((e=>{e.classList.remove("active")})),40===o.keyCode?(s[n=(n+1)%s.length].classList.add("active"),t.scrollTop=s[n].offsetTop,s[n].focus()):38===o.keyCode?(s[n=(n-1+s.length)%s.length].classList.add("active"),t.scrollTop=s[n].offsetTop,s[n].focus()):e.focus()}));const a=()=>{const e=Date.now(),t=localStorage.getItem("lastUpdatedSearchTerms");t&&e-t<72e5||fetch(popularSearchesURL).then((e=>e.json())).then((t=>{localStorage.setItem("popularSearches",JSON.stringify(t)),localStorage.setItem("lastUpdatedSearchTerms",e.toString())})).catch((e=>{console.error("Error fetching popular searches:",e)}))};a(),setInterval(a,72e5)}));